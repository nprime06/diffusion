/orcd/home/002/willzhao/diffusion/src/methods/ddpm/loss.py:13: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(device_type=x0.device.type, dtype=torch.bfloat16):
Traceback (most recent call last):
  File "/home/willzhao/diffusion/src/main.py", line 113, in <module>
    trained_model = train_ddpm(model, dataloader, scheduler, train_config, device, images_mean, images_std)
  File "/orcd/home/002/willzhao/diffusion/src/training/train_ddpm.py", line 33, in train_ddpm
    loss_val = loss(model, images, scheduler)
  File "/orcd/home/002/willzhao/diffusion/src/methods/ddpm/loss.py", line 13, in loss
    with autocast(device_type=x0.device.type, dtype=torch.bfloat16):
  File "/orcd/software/core/001/pkg/miniforge/24.3.0-0/lib/python3.10/site-packages/typing_extensions.py", line 2853, in wrapper
    return arg(*args, **kwargs)
TypeError: autocast.__init__() got an unexpected keyword argument 'device_type'
